function count = countNonZero(S)
    count = sum(S(:) ~= 0); % Count non-zero values in the matrix S
end